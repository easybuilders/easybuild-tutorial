
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://easybuilders.github.io/easybuild-tutorial/2021-lust/implementing_easyblocks/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.16">
    
    
      
        <title>Implementing easyblocks - EasyBuild tutorial</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.1c3799f8.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cc9b2e1e.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#implementing-easyblocks" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="EasyBuild tutorial" class="md-header__button md-logo" aria-label="EasyBuild tutorial" data-md-component="logo">
      
  <img src="../../img/easybuild_logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            EasyBuild tutorial
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Implementing easyblocks
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/easybuilders" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    EasyBuild @ GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="EasyBuild tutorial" class="md-nav__button md-logo" aria-label="EasyBuild tutorial" data-md-component="logo">
      
  <img src="../../img/easybuild_logo.png" alt="logo">

    </a>
    EasyBuild tutorial
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/easybuilders" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    EasyBuild @ GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          ISC'22 (29 May 2022)
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="ISC'22 (29 May 2022)" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          ISC'22 (29 May 2022)
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2022-isc22/" class="md-nav__link">
        (overview)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2022-isc22/practical_info/" class="md-nav__link">
        Practical info
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2022-isc22/introduction/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2022-isc22/terminology/" class="md-nav__link">
        Terminology
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2022-isc22/installation/" class="md-nav__link">
        Installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2022-isc22/configuration/" class="md-nav__link">
        Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2022-isc22/basic_usage/" class="md-nav__link">
        Basic usage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2022-isc22/installing_software/" class="md-nav__link">
        Installing software
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2022-isc22/troubleshooting/" class="md-nav__link">
        Troubleshooting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2022-isc22/adding_support_additional_software/" class="md-nav__link">
        Support for additional software
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2022-isc22/module_naming_schemes/" class="md-nav__link">
        Module naming schemes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2022-isc22/integration_jsc/" class="md-nav__link">
        Integration of EasyBuild in JSC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2022-isc22/integration_eessi/" class="md-nav__link">
        Integration of EasyBuild in EESSI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2022-isc22/integration_lumi/" class="md-nav__link">
        Integration of EasyBuild in LUMI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2022-isc22/community/" class="md-nav__link">
        The EasyBuild community
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2022-isc22/contributing/" class="md-nav__link">
        Contributing to EasyBuild
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2022-isc22/comparison_other_tools/" class="md-nav__link">
        Comparison with other tools
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Archive
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Archive" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Archive
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1" type="checkbox" id="__nav_3_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1">
          ISC'21 (25 June 2021)
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="ISC'21 (25 June 2021)" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          ISC'21 (25 June 2021)
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2021-isc21/" class="md-nav__link">
        (overview)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2021-isc21/practical_info/" class="md-nav__link">
        Practical info
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2021-isc21/introduction/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2021-isc21/terminology/" class="md-nav__link">
        Terminology
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2021-isc21/installation/" class="md-nav__link">
        Installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2021-isc21/configuration/" class="md-nav__link">
        Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2021-isc21/basic_usage/" class="md-nav__link">
        Basic usage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2021-isc21/installing_software/" class="md-nav__link">
        Installing software
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2021-isc21/troubleshooting/" class="md-nav__link">
        Troubleshooting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2021-isc21/module_naming_schemes/" class="md-nav__link">
        Module naming schemes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2021-isc21/adding_support_additional_software/" class="md-nav__link">
        Support for additional software
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2021-isc21/jsc/" class="md-nav__link">
        EasyBuild at JSC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2021-isc21/computecanada/" class="md-nav__link">
        EasyBuild at Compute Canada
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2021-isc21/community/" class="md-nav__link">
        The EasyBuild community
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2021-isc21/contributing/" class="md-nav__link">
        Contributing to EasyBuild
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" type="checkbox" id="__nav_3_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3_2">
          LUST (spring '21)
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="LUST (spring '21)" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          LUST (spring '21)
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        (overview)
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2_2" type="checkbox" id="__nav_3_2_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_2_2">
          Introduction to EasyBuild
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Introduction to EasyBuild" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_2_2">
          <span class="md-nav__icon md-icon"></span>
          Introduction to EasyBuild
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../part1_intro/" class="md-nav__link">
        (overview)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../what_is_easybuild/" class="md-nav__link">
        What is EasyBuild?
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../terminology/" class="md-nav__link">
        Terminology
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        Installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/" class="md-nav__link">
        Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../basic_usage/" class="md-nav__link">
        Basic usage
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2_3" type="checkbox" id="__nav_3_2_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3_2_3">
          Using EasyBuild
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Using EasyBuild" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_2_3">
          <span class="md-nav__icon md-icon"></span>
          Using EasyBuild
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../part2_using/" class="md-nav__link">
        (overview)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../troubleshooting/" class="md-nav__link">
        Troubleshooting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../creating_easyconfig_files/" class="md-nav__link">
        Creating easyconfig files
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Implementing easyblocks
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Implementing easyblocks
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-basics" class="md-nav__link">
    The basics
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generic-vs-software-specific-easyblocks" class="md-nav__link">
    Generic vs software-specific easyblocks
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#naming" class="md-nav__link">
    Naming
  </a>
  
    <nav class="md-nav" aria-label="Naming">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#python-class-name" class="md-nav__link">
    Python class name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python-module-name-and-location" class="md-nav__link">
    Python module name and location
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure-of-an-easyblock" class="md-nav__link">
    Structure of an easyblock
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deriving-from-existing-easyblocks" class="md-nav__link">
    Deriving from existing easyblocks
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#easyconfig-parameters" class="md-nav__link">
    Easyconfig parameters
  </a>
  
    <nav class="md-nav" aria-label="Easyconfig parameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#updating-parameters" class="md-nav__link">
    Updating parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-parameters" class="md-nav__link">
    Custom parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#easyblock-constructor" class="md-nav__link">
    Easyblock constructor
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-operations" class="md-nav__link">
    File operations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#executing-shell-commands" class="md-nav__link">
    Executing shell commands
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#manipulating-environment-variables" class="md-nav__link">
    Manipulating environment variables
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#logging-and-errors" class="md-nav__link">
    Logging and errors
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-sanity-check" class="md-nav__link">
    Custom sanity check
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#version-specific-parts" class="md-nav__link">
    Version-specific parts
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compatibility-with-extended-dry-run-and-module-only" class="md-nav__link">
    Compatibility with --extended-dry-run and --module-only
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise" class="md-nav__link">
    Exercise
  </a>
  
    <nav class="md-nav" aria-label="Exercise">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#exercise-i1" class="md-nav__link">
    Exercise I.1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-i2" class="md-nav__link">
    Exercise I.2
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2_4" type="checkbox" id="__nav_3_2_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_2_4">
          Advanced topics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Advanced topics" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_2_4">
          <span class="md-nav__icon md-icon"></span>
          Advanced topics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../part3_advanced/" class="md-nav__link">
        (overview)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../easybuild_library/" class="md-nav__link">
        Using EasyBuild as a library
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../hooks/" class="md-nav__link">
        Using hooks to customise EasyBuild
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../slurm_jobs/" class="md-nav__link">
        Submitting installations as Slurm jobs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../module_naming_schemes/" class="md-nav__link">
        Module naming schemes (incl. hierarchical)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../github_integration/" class="md-nav__link">
        GitHub integration to facilitate contributing to EasyBuild
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2_5" type="checkbox" id="__nav_3_2_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_2_5">
          EasyBuild on Cray systems
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="EasyBuild on Cray systems" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_2_5">
          <span class="md-nav__icon md-icon"></span>
          EasyBuild on Cray systems
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../part4_cray/" class="md-nav__link">
        (overview)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cray/introduction/" class="md-nav__link">
        Introduction to the Cray PE
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cray/external_modules/" class="md-nav__link">
        Using external modules
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cray/custom_toolchains/" class="md-nav__link">
        Custom Cray toolchains
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cray/easybuild_at_cscs/" class="md-nav__link">
        EasyBuild at CSCS
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3" type="checkbox" id="__nav_3_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_3">
          ISC'20 (June '20)
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="ISC'20 (June '20)" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_3">
          <span class="md-nav__icon md-icon"></span>
          ISC'20 (June '20)
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2020-06-isc20/" class="md-nav__link">
        Start page
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2020-06-isc20/practical_information/" class="md-nav__link">
        Practical information
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2020-06-isc20/introduction/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2020-06-isc20/installation/" class="md-nav__link">
        Installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2020-06-isc20/configuration/" class="md-nav__link">
        Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2020-06-isc20/basic_usage/" class="md-nav__link">
        Basic usage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2020-06-isc20/troubleshooting/" class="md-nav__link">
        Troubleshooting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2020-06-isc20/hmns/" class="md-nav__link">
        Hierarchical module naming schemes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2020-06-isc20/adding_support_software/" class="md-nav__link">
        Adding support for additional software
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2020-06-isc20/jsc/" class="md-nav__link">
        EasyBuild at JÃ¼lich Supercomputing Centre
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2020-06-isc20/computecanada/" class="md-nav__link">
        EasyBuild at Compute Canada
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2020-06-isc20/community/" class="md-nav__link">
        The EasyBuild community
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2020-06-isc20/contributing/" class="md-nav__link">
        Contributing to EasyBuild
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2020-06-isc20/comparison_other_tools/" class="md-nav__link">
        Comparison with other tools
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2020-06-isc20/getting_help/" class="md-nav__link">
        Getting help
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-basics" class="md-nav__link">
    The basics
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generic-vs-software-specific-easyblocks" class="md-nav__link">
    Generic vs software-specific easyblocks
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#naming" class="md-nav__link">
    Naming
  </a>
  
    <nav class="md-nav" aria-label="Naming">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#python-class-name" class="md-nav__link">
    Python class name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python-module-name-and-location" class="md-nav__link">
    Python module name and location
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure-of-an-easyblock" class="md-nav__link">
    Structure of an easyblock
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deriving-from-existing-easyblocks" class="md-nav__link">
    Deriving from existing easyblocks
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#easyconfig-parameters" class="md-nav__link">
    Easyconfig parameters
  </a>
  
    <nav class="md-nav" aria-label="Easyconfig parameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#updating-parameters" class="md-nav__link">
    Updating parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-parameters" class="md-nav__link">
    Custom parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#easyblock-constructor" class="md-nav__link">
    Easyblock constructor
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-operations" class="md-nav__link">
    File operations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#executing-shell-commands" class="md-nav__link">
    Executing shell commands
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#manipulating-environment-variables" class="md-nav__link">
    Manipulating environment variables
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#logging-and-errors" class="md-nav__link">
    Logging and errors
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-sanity-check" class="md-nav__link">
    Custom sanity check
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#version-specific-parts" class="md-nav__link">
    Version-specific parts
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compatibility-with-extended-dry-run-and-module-only" class="md-nav__link">
    Compatibility with --extended-dry-run and --module-only
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise" class="md-nav__link">
    Exercise
  </a>
  
    <nav class="md-nav" aria-label="Exercise">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#exercise-i1" class="md-nav__link">
    Exercise I.1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-i2" class="md-nav__link">
    Exercise I.2
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
  <a href="https://github.com/easybuilders/easybuild-tutorial/edit/main/docs/2021-lust/implementing_easyblocks.md" title="Edit this page" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>



<h1 id="implementing-easyblocks">Implementing easyblocks<a class="headerlink" href="#implementing-easyblocks" title="Permanent link">&para;</a></h1>
<h2 id="the-basics">The basics<a class="headerlink" href="#the-basics" title="Permanent link">&para;</a></h2>
<p>An <em>easyblock</em> is a Python module that implements a software build and installation procedure.</p>
<p>This concept is essentially implemented as a Python script that plugs into the EasyBuild framework.</p>
<p>EasyBuild will leverage easyblocks as needed, depending on which software packages it needs to install. Which easyblock is required is determined by the <code>easyblock</code> easyconfig parameter, if it is present, or by the software name.</p>
<h2 id="generic-vs-software-specific-easyblocks">Generic vs software-specific easyblocks<a class="headerlink" href="#generic-vs-software-specific-easyblocks" title="Permanent link">&para;</a></h2>
<p>Easyblocks can either be <em>generic</em> or <em>software-specific</em>.</p>
<p><em>Generic</em> easyblocks implement a "standard" software build and installation procedure that is used by multiple different
software packages.
A commonly used example is the
<a href="https://github.com/easybuilders/easybuild-easyblocks/blob/main/easybuild/easyblocks/generic/configuremake.py"><code>ConfigureMake</code></a>
generic easyblock, which implements the standard <code>configure</code> - <code>make</code> - <code>make install</code> installation procedure used
by most GNU software packages.</p>
<p><em>Software-specific</em> easyblocks implement the build and installation procedure for a particular software package.
Typically this involves highly customised steps, for example specifying dedicated configuration options, creating
or adjusting specific files, executing non-standard shell commands, etc. Usually a custom implementation of the
sanity check is also included.</p>
<p>Using a generic easyblock requires specifying the <code>easyblock</code> parameter in the easyconfig file.
If it is not specified, EasyBuild will try and find the software-specific easyblock derived from the software name.</p>
<p>The distinction between generic and software-specific easyblocks can be made based on the naming scheme that is used
for an easyblock (see below).</p>
<h2 id="naming">Naming<a class="headerlink" href="#naming" title="Permanent link">&para;</a></h2>
<p>Easyblocks need to follow a strict naming scheme, to ensure that EasyBuild can pick them up as needed. This involves two aspects:</p>
<ul>
<li>the name of the Python class;</li>
<li>the name and location of the Python module file.</li>
</ul>
<h3 id="python-class-name">Python class name<a class="headerlink" href="#python-class-name" title="Permanent link">&para;</a></h3>
<p>The name of the Python class is determined by the <em>software name</em> for software-specific easyblocks.
It consists of a prefix '<code>EB_</code>', followed by the (encoded) software name.</p>
<p>Because of limitations in Python on characters allowed in names of Python classes,
only alphanumeric characters and underscores (<code>_</code>) are allowed. Any other characters are replaced following an encoding scheme:</p>
<ul>
<li>spaces are replaced by underscores (<code>_</code>);</li>
<li>dashes <code>-</code> are replaced by <code>_minus_</code>;</li>
<li>underscores are replaced by <code>_underscore_</code>;</li>
</ul>
<p>The <code>encode_class_name</code> function provided in <code>easybuild.tools.filetools</code> returns the expected class name
for a given software name; for example:</p>
<div class="highlight"><pre><span></span><code>$ python3 -c <span class="s2">&quot;from easybuild.tools.filetools import encode_class_name; print(encode_class_name(&#39;netCDF-Fortran&#39;))&quot;</span>
EB_netCDF_minus_Fortran
</code></pre></div>
<p><strong>Python class name for <em>generic</em> easyblocks</strong></p>
<p>For <em>generic</em> easyblocks, the class name does <em>not</em> include an <code>EB_</code> prefix (since there is no need for an escaping
mechanism) and hence the name is fully free to choose, taking into account the restriction to alphanumeric characters
and underscores.</p>
<p>For code style reasons, the class name should start with a capital letter and use CamelCasing.</p>
<p>Examples include <code>Bundle</code>, <code>ConfigureMake</code>, <code>CMakePythonPackage</code>.</p>
<h3 id="python-module-name-and-location">Python module name and location<a class="headerlink" href="#python-module-name-and-location" title="Permanent link">&para;</a></h3>
<p>The <em>filename</em> of the Python module is directly related to the name of Python class it provides.</p>
<p>It should:</p>
<ul>
<li><em>not</em> include the <code>EB_</code> prefix of the class name for software-specific easyblocks;</li>
<li>consists only of lower-case alphanumeric characters (<code>[a-z0-9]</code>) and underscores (<code>_</code>);<ul>
<li>dashes (<code>-</code>) are replaced by underscores (<code>_</code>);</li>
<li>any other non-alphanumeric characters (incl. spaces) are simply dropped;</li>
</ul>
</li>
</ul>
<p>Examples include:</p>
<ul>
<li><code>gcc.py</code> (for <em>GCC</em>)</li>
<li><code>netcdf_fortran.py</code> (for <em>netCDF-Fortran</em>)</li>
<li><code>gamess_us.py</code> (for <em>GAMESS (US)</em>)</li>
</ul>
<p>The <code>get_module_path</code> function provided by the EasyBuild framework in the
<code>easybuild.framework.easyconfig.easyconfig</code> module returns the (full)
module location for a particular software name or easyblock class name. For example:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">easybuild.framework.easyconfig.easyconfig</span> <span class="kn">import</span> <span class="n">get_module_path</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">get_module_path</span><span class="p">(</span><span class="s1">&#39;netCDF-Fortran&#39;</span><span class="p">)</span>
<span class="s1">&#39;easybuild.easyblocks.netcdf_fortran&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">get_module_path</span><span class="p">(</span><span class="s1">&#39;EB_netCDF_minus_Fortran&#39;</span><span class="p">)</span>
<span class="s1">&#39;easybuild.easyblocks.netcdf_fortran&#39;</span>
</code></pre></div>
<p>The location of the Python module is determined by whether the easyblock is generic or software-specific.
Generic easyblocks are located in the <code>easybuid.easyblocks.generic</code> namespace, while software-specific easyblocks
live in the <code>easybuild.easyblocks</code> namespace directly.</p>
<p>To keep things organised, the actual Python module files
for software-specific easyblocks are kept in 'letter' subdirectories,
rather than in one large '<code>easyblocks</code>' directory
(see
<a href="https://github.com/easybuilders/easybuild-easyblocks/tree/main/easybuild/easyblocks">https://github.com/easybuilders/easybuild-easyblocks/tree/main/easybuild/easyblocks</a>),
but this namespace is collapsed transparently by EasyBuild (you don't need to import from letter subpackages).</p>
<p>To let EasyBuild pick up one or more new or customized easyblocks, you can use the <a href="https://docs.easybuild.io/en/latest/Including_additional_Python_modules.html#including-additional-easyblocks-include-easyblocks"><code>--include-easyblocks</code></a>
configuration option. As long as both the filename of the Python module and the name of the Python class
are correct, EasyBuild will use these easyblocks when needed.</p>
<h2 id="structure-of-an-easyblock">Structure of an easyblock<a class="headerlink" href="#structure-of-an-easyblock" title="Permanent link">&para;</a></h2>
<p>The example below shows the overal structure of an easyblock:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">easybuild.framework.easyblock</span> <span class="kn">import</span> <span class="n">EasyBlock</span>
<span class="kn">from</span> <span class="nn">easybuild.tools.run</span> <span class="kn">import</span> <span class="n">run_cmd</span>


<span class="k">class</span> <span class="nc">EB_Example</span><span class="p">(</span><span class="n">EasyBlock</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Custom easyblock for Example&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">configure_step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Custom implementation of configure step for Example&quot;&quot;&quot;</span>

        <span class="c1"># run configure.sh to configure the build</span>
        <span class="n">run_cmd</span><span class="p">(</span><span class="s2">&quot;./configure.sh --install-prefix=</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">installdir</span><span class="p">)</span>
</code></pre></div>
<p>Each easyblock includes an implementation of a <code>class</code> that (directly or indirectly) derives from the abstract
<code>EasyBlock</code> class.</p>
<p>Typically some useful functions provided by the EasyBuild framework are imported at the top of the Python module.</p>
<p>In the class definition, one or more '<code>*_step</code>' methods (and perhaps a couple of others) are redefined,
to implement the corresponding step in the build and installation procedure.</p>
<p>Each easyblock <em>must</em> implement the <code>configure</code>, <code>build</code> and <code>install</code> steps, since these are not implemented
in the abstract <code>EasyBlock</code> class. This could be done explicitly by redefining the corresponding <code>*_step</code> methods,
or implicitly by deriving from existing (generic) easyblocks.</p>
<p>The full list of methods that can be redefined in an easyblock can be consulted in
the <a href="https://docs.easybuild.io/en/latest/api/easybuild.framework.easyblock.html">API documentation</a>.</p>
<h2 id="deriving-from-existing-easyblocks">Deriving from existing easyblocks<a class="headerlink" href="#deriving-from-existing-easyblocks" title="Permanent link">&para;</a></h2>
<p>When implementing an easyblock, it is common to derive from an existing (usually generic) easyblock,
and to leverage the functionality provided by it. This approach is typically used when only a specific part
of the build and installation procedure needs to be customised.</p>
<p>In the (fictitious) example below, we derive from the generic <code>ConfigureMake</code> easyblock to redefine the <code>configure</code>
step. In this case, we are <em>extending</em> the <code>configure</code> step as implemented by <code>ConfigureMake</code> rather than
redefining it entirely, since we call out to the original <code>configure_step</code> method at the end.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">easybuild.easyblocks.generic.configuremake</span> <span class="kn">import</span> <span class="n">ConfigureMake</span>
<span class="kn">from</span> <span class="nn">easybuild.tools.filetools</span> <span class="kn">import</span> <span class="n">copy_file</span>


<span class="k">class</span> <span class="nc">EB_Example</span><span class="p">(</span><span class="n">ConfigureMake</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Custom easyblock for Example&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">configure_step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Custom implementation of configure step for Example&quot;&quot;&quot;</span>

        <span class="c1"># use example make.cfg for x86-64</span>
        <span class="n">copy_file</span><span class="p">(</span><span class="s1">&#39;make.cfg.x86&#39;</span><span class="p">,</span> <span class="s1">&#39;make.cfg&#39;</span><span class="p">)</span>

        <span class="c1"># call out to original configure_step implementation of ConfigureMake easyblock</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">EB_Example</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">configure_step</span><span class="p">()</span>
</code></pre></div>
<h2 id="easyconfig-parameters">Easyconfig parameters<a class="headerlink" href="#easyconfig-parameters" title="Permanent link">&para;</a></h2>
<p>All of the easyconfig parameters that are defined in an easyconfig file
are available via the <code>EasyConfig</code> instance that can be accessed through <code>self.cfg</code> in an easyblock.
For instance, if the easyconfig file specifies</p>
<div class="highlight"><pre><span></span><code><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;example&#39;</span>
<span class="n">version</span> <span class="o">=</span> <span class="s1">&#39;2.5.3&#39;</span>
<span class="n">versionsuffix</span> <span class="o">=</span> <span class="s1">&#39;-Python-3.7.4&#39;</span>
</code></pre></div>
<p>then these three parameters are accessible within an easyblock via <code>self.cfg['name']</code>, <code>self.cfg['version']</code>
and <code>self.cfg['versionsuffix']</code>.</p>
<p>A few of the most commonly used parameters can be referenced directly:</p>
<ul>
<li><strong><code>self.name</code></strong> is equivalent with <code>self.cfg['name']</code>;</li>
<li><strong><code>self.version</code></strong> is equivalent with <code>self.cfg['version']</code>;</li>
<li><strong><code>self.toolchain</code></strong> is equivalent with <code>self.cfg['toolchain']</code>;</li>
</ul>
<h3 id="updating-parameters">Updating parameters<a class="headerlink" href="#updating-parameters" title="Permanent link">&para;</a></h3>
<p>You will often find that you need to <em>update</em> some easyconfig parameters in an easyblock,
for example <code>configopts</code> which specifies options for the configure command.</p>
<p>Because of implementation details (related to
how template values like <code>%(version)s</code> are handled), you need to be a bit careful here...</p>
<p>To completely redefine the value of an easyconfig parameter, you can use simple assignment. For example:</p>
<div class="highlight"><pre><span></span><code><span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="p">[</span><span class="s1">&#39;example&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;A new value for the example easyconfig parameter.&quot;</span>
</code></pre></div>
<p>If want to <em>add</em> to the existing value however, you <em>must</em> use the <code>self.cfg.update</code> method. For example:</p>
<div class="highlight"><pre><span></span><code><span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s1">&#39;some_list&#39;</span><span class="p">,</span> <span class="s1">&#39;example&#39;</span><span class="p">)</span>
</code></pre></div>
<p>This will <strong><em>not</em></strong> work (because <code>self.cfg['some_list']</code> does not return a reference to the original value,
but to a <em>temporary copy</em> thereof):</p>
<div class="highlight"><pre><span></span><code><span class="c1"># anti-pattern, this does NOT work as expected!</span>
<span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="p">[</span><span class="s1">&#39;some_list&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;example&#39;</span><span class="p">)</span>
</code></pre></div>
<h3 id="custom-parameters">Custom parameters<a class="headerlink" href="#custom-parameters" title="Permanent link">&para;</a></h3>
<p>Additional custom easyconfig parameters can be defined in an easyblock to allowing steering its behaviour.
This is done via the <code>extra_options</code> <em>static</em> method. Custom parameters can be specified to be mandatory.</p>
<p>The example below shows how this can be implemented:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">easybuild.easyblocks.generic.configuremake</span> <span class="kn">import</span> <span class="n">ConfigureMake</span>
<span class="kn">from</span> <span class="nn">easybuild.framework.easyconfig</span> <span class="kn">import</span> <span class="n">CUSTOM</span><span class="p">,</span> <span class="n">MANDATORY</span>


<span class="k">class</span> <span class="nc">EB_Example</span><span class="p">(</span><span class="n">ConfigureMake</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Custom easyblock for Example&quot;&quot;&quot;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">extra_options</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;Custom easyconfig parameters for Example&quot;&quot;&quot;</span>
        <span class="n">extra_vars</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;required_example_param&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Example required custom parameter&quot;</span><span class="p">,</span> <span class="n">MANDATORY</span><span class="p">],</span>
            <span class="s1">&#39;optional_example_param&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Example optional custom parameter&quot;</span><span class="p">,</span> <span class="n">CUSTOM</span><span class="p">],</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">ConfigureMake</span><span class="o">.</span><span class="n">extra_options</span><span class="p">(</span><span class="n">extra_vars</span><span class="p">)</span>
</code></pre></div>
<p>The first element in the list of a defined custom parameter corresponds to the default value for that parameter
(both <code>None</code> in the example above). The second element provides some informative help text, and the last element
indicates whether the parameter is mandatory (<code>MANDATORY</code>) or just an optional custom parameter (<code>CUSTOM</code>).</p>
<h2 id="easyblock-constructor">Easyblock constructor<a class="headerlink" href="#easyblock-constructor" title="Permanent link">&para;</a></h2>
<p>In the <code>class</code> constructor of the easyblock, i.e. the <code>__init__</code> method, one or more class variables
can be initialised. These can be used for sharing information between different <code>*_step</code> methods in the easyblock.</p>
<p>For example:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">easybuild.framework.easyblock</span> <span class="kn">import</span> <span class="n">EasyBlock</span>


<span class="k">class</span> <span class="nc">EB_Example</span><span class="p">(</span><span class="n">EasyBlock</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Custom easyblock for Example&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Constructor for Example easyblock, initialises class variables.&quot;&quot;&quot;</span>

        <span class="c1"># call out to original constructor first, so &#39;self&#39; (i.e. the class instance) is initialised</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">EB_Example</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># initialise class variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">example_value</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">example_list</span> <span class="o">=</span> <span class="p">[]</span>
</code></pre></div>
<h2 id="file-operations">File operations<a class="headerlink" href="#file-operations" title="Permanent link">&para;</a></h2>
<p>File operations is a common use case for implementing easyblocks, hence the EasyBuild framework provides a
number of useful functions related to this, including:</p>
<ul>
<li>
<p><code>read_file(&lt;path&gt;)</code>: read file at a specified location and returns its contents;</p>
</li>
<li>
<p><code>write_file(&lt;path&gt;, &lt;text&gt;)</code> at a specified location with provided contents;
  to append to an existing file, use <code>append=True</code> as an extra argument;</p>
</li>
<li>
<p><code>copy_file(&lt;src&gt;, &lt;dest&gt;)</code> to copy an existing file;</p>
</li>
<li>
<p><code>apply_regex_substitutions(&lt;path&gt;, &lt;list of regex substitutions&gt;)</code> to patch an existing file;</p>
</li>
</ul>
<p>All of these functions are provided by the <a href="https://docs.easybuild.io/en/latest/api/easybuild.tools.filetools.html"><code>easybuild.tools.filetools</code></a> module.</p>
<h2 id="executing-shell-commands">Executing shell commands<a class="headerlink" href="#executing-shell-commands" title="Permanent link">&para;</a></h2>
<p>For executing shell commands two functions are provided by the
<a href="https://docs.easybuild.io/en/latest/api/easybuild.tools.run.html"><code>easybuild.tools.run</code></a> module:</p>
<ul>
<li>
<p><code>run_cmd(&lt;cmd&gt;)</code> to run a non-interactive shell command;</p>
</li>
<li>
<p><code>run_cmd_qa(&lt;cmd&gt;, &lt;dict with questions &amp; answers&gt;)</code> to run an interactive shell command;</p>
</li>
</ul>
<p>Both of these accept a number of optional arguments:</p>
<ul>
<li>
<p><code>simple=True</code> to just return <code>True</code> or <code>False</code> to indicate a successful execution,
  rather than the default return value, i.e., a tuple that provides the command output and the exit code (in that
  order);</p>
</li>
<li>
<p><code>path=&lt;path&gt;</code> to run the command in a specific subdirectory;</p>
</li>
</ul>
<p>The <code>run_cmd_qa</code> function takes two additional specific arguments:</p>
<ul>
<li>
<p><code>no_qa=&lt;list&gt;</code> to specify a list of patterns to recognize non-questions;</p>
</li>
<li>
<p><code>std_qa=&lt;dict&gt;</code> to specify regular expression patterns for common questions, and the matching answer;</p>
</li>
</ul>
<h2 id="manipulating-environment-variables">Manipulating environment variables<a class="headerlink" href="#manipulating-environment-variables" title="Permanent link">&para;</a></h2>
<p>To (re)define environment variables, the <code>setvar</code> function provided by the
<a href="https://docs.easybuild.io/en/latest/api/easybuild.tools.environment.html"><code>easybuild.tools.environment</code></a>
module should be used.</p>
<p>This makes sure that the changes being made to the specified environment variable are kept track of,
and that they are handled correctly under <code>--extended-dry-run</code>.</p>
<h2 id="logging-and-errors">Logging and errors<a class="headerlink" href="#logging-and-errors" title="Permanent link">&para;</a></h2>
<p>It is good practice to include meaningful log messages in the <code>*_step</code> methods being customised in the easyblock,
to enrich the EasyBuild log with useful information for later debugging or diagnostics.</p>
<p>For logging, the provided <code>self.log</code> logger class should be used.
You can use the <code>self.log.info</code> method to log an informative message.
Similar methods are available for logging debug messages (<code>self.log.debug</code>), which are
only emitted when <code>eb</code> is run with debugging mode enabled (<code>--debug</code> or <code>-d</code>),
and for logging warning messages (<code>self.log.warning</code>).</p>
<p>If something goes wrong, you can raise an <code>EasyBuildError</code> instance to report the error.</p>
<p>For example:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">easybuild.framework.easyblock</span> <span class="kn">import</span> <span class="n">EasyBlock</span>
<span class="kn">from</span> <span class="nn">easybuild.tools.build_log</span> <span class="kn">import</span> <span class="n">EasyBuildError</span>
<span class="kn">from</span> <span class="nn">easybuild.tools.run</span> <span class="kn">import</span> <span class="n">run_cmd</span>


<span class="k">class</span> <span class="nc">EB_Example</span><span class="p">(</span><span class="n">EasyBlock</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Custom easyblock for Example&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">configure_step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Custom implementation of configure step for Example&quot;&quot;&quot;</span>

        <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&quot;./configure --prefix </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">installdir</span><span class="p">)</span>
        <span class="n">out</span><span class="p">,</span> <span class="n">ec</span> <span class="o">=</span> <span class="n">run_cmd</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>

        <span class="n">success</span> <span class="o">=</span> <span class="s1">&#39;SUCCESS&#39;</span>
        <span class="k">if</span> <span class="n">success</span> <span class="ow">in</span> <span class="n">out</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Configuration command &#39;</span><span class="si">%s</span><span class="s2">&#39; completed with success.&quot;</span> <span class="o">%</span> <span class="n">cmd</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">EasyBuildError</span><span class="p">(</span><span class="s2">&quot;Pattern &#39;</span><span class="si">%s</span><span class="s2">&#39; was not found in output of &#39;</span><span class="si">%s</span><span class="s2">&#39;.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">success</span><span class="p">,</span> <span class="n">cmd</span><span class="p">))</span>
</code></pre></div>
<h2 id="custom-sanity-check">Custom sanity check<a class="headerlink" href="#custom-sanity-check" title="Permanent link">&para;</a></h2>
<p>For software-specific easyblocks, a custom sanity check is usually included to verify that the installation was
successful or not.</p>
<p>This is done by redefining the <code>sanity_check_step</code> method in the easyblock. For example:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">easybuild.framework.easyblock</span> <span class="kn">import</span> <span class="n">EasyBlock</span>

<span class="k">class</span> <span class="nc">EB_Example</span><span class="p">(</span><span class="n">EasyBlock</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Custom easyblock for Example&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">sanity_check_step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Custom sanity check for Example.&quot;&quot;&quot;</span>

        <span class="n">custom_paths</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;files&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;bin/example&#39;</span><span class="p">],</span>
            <span class="s1">&#39;dirs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;lib/examples/&#39;</span><span class="p">],</span>
        <span class="p">}</span>
        <span class="n">custom_commands</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;example --version&#39;</span><span class="p">]</span>

        <span class="c1"># call out to parent to do the actual sanity checking, pass through custom paths and commands</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">EB_Example</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">sanity_check_step</span><span class="p">(</span><span class="n">custom_paths</span><span class="o">=</span><span class="n">custom_paths</span><span class="p">,</span> <span class="n">custom_commands</span><span class="o">=</span><span class="n">custom_commands</span><span class="p">)</span>
</code></pre></div>
<p>You can both specify file paths and subdirectories to check for, which are specified relative to the installation directory,
as well as simple commands that should execute successfully after completing the installation and loading the generated module file.</p>
<p>It is up to you how extensive you make the sanity check, but it is recommended to make the check as complete
as possible to catch any potential build or installation problems that may occur, while ensuring that it can
run relatively quickly (in seconds, or at most a couple of minutes).</p>
<h2 id="version-specific-parts">Version-specific parts<a class="headerlink" href="#version-specific-parts" title="Permanent link">&para;</a></h2>
<p>In some cases version-specific actions or checks need to be included in an easyblock.
For this, it is recommended to use <code>LooseVersion</code> rather than directly comparing version numbers using string values.</p>
<p>For example:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">distutils.version</span> <span class="kn">import</span> <span class="n">LooseVersion</span>
<span class="kn">from</span> <span class="nn">easybuild.framework.easyblock</span> <span class="kn">import</span> <span class="n">EasyBlock</span>


<span class="k">class</span> <span class="nc">EB_Example</span><span class="p">(</span><span class="n">EasyBlock</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Custom easyblock for Example&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">sanity_check_step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Custom sanity check for Example.&quot;&quot;&quot;</span>

        <span class="n">custom_paths</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;files&#39;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s1">&#39;dirs&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="p">}</span>

        <span class="c1"># in older versions, the binary used to be named &#39;EXAMPLE&#39; rather than &#39;example&#39;</span>
        <span class="k">if</span> <span class="n">LooseVersion</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">LooseVersion</span><span class="p">(</span><span class="s1">&#39;1.0&#39;</span><span class="p">):</span>
            <span class="n">custom_paths</span><span class="p">[</span><span class="s1">&#39;files&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;bin/EXAMPLE&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">custom_paths</span><span class="p">[</span><span class="s1">&#39;files&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;bin/example&#39;</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">EB_Example</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">sanity_check_step</span><span class="p">(</span><span class="n">custom_paths</span><span class="o">=</span><span class="n">custom_paths</span><span class="p">)</span>
</code></pre></div>
<h2 id="compatibility-with-extended-dry-run-and-module-only">Compatibility with <code>--extended-dry-run</code> and <code>--module-only</code><a class="headerlink" href="#compatibility-with-extended-dry-run-and-module-only" title="Permanent link">&para;</a></h2>
<p>Some special care must be taken to ensure that an easyblock is fully compatible with <code>--extended-dry-run</code> / <code>-x</code>
(see <a href="../basic_usage/#inspecting-install-procedures">Inspecting install procedures</a>) and <code>--module-only</code>.</p>
<p>For compatibility with <code>--extended-dry-run</code>, you need to take into account that specified operations
like manipulating files or running shell commands will not actually be executed. You can check
whether an easyblock is being run in dry run mode via <code>self.dry_run</code>.</p>
<p>For example:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">easybuild.framework.easyblock</span> <span class="kn">import</span> <span class="n">EasyBlock</span>
<span class="kn">from</span> <span class="nn">easybuild.tools.build_log</span> <span class="kn">import</span> <span class="n">EasyBuildError</span>
<span class="kn">from</span> <span class="nn">easybuild.tools.run</span> <span class="kn">import</span> <span class="n">run_cmd</span>


<span class="k">class</span> <span class="nc">EB_Example</span><span class="p">(</span><span class="n">EasyBlock</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Custom easyblock for Example&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">configure_step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Custom implementation of configure step for Example&quot;&quot;&quot;</span>

        <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&quot;./configure --prefix </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">installdir</span><span class="p">)</span>
        <span class="n">out</span><span class="p">,</span> <span class="n">ec</span> <span class="o">=</span> <span class="n">run_cmd</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>

        <span class="n">success</span> <span class="o">=</span> <span class="s1">&#39;SUCCESS&#39;</span>
        <span class="k">if</span> <span class="n">success</span> <span class="ow">in</span> <span class="n">out</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Configuration command &#39;</span><span class="si">%s</span><span class="s2">&#39; completed with success.&quot;</span> <span class="o">%</span> <span class="n">cmd</span><span class="p">)</span>

        <span class="c1"># take into account that in dry run mode we won&#39;t get any output at all</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dry_run</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Ignoring missing &#39;</span><span class="si">%s</span><span class="s2">&#39; pattern since we&#39;re running in dry run mode.&quot;</span> <span class="o">%</span> <span class="n">success</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">EasyBuildError</span><span class="p">(</span><span class="s2">&quot;Pattern &#39;</span><span class="si">%s</span><span class="s2">&#39; was not found in output of &#39;</span><span class="si">%s</span><span class="s2">&#39;.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">success</span><span class="p">,</span> <span class="n">cmd</span><span class="p">))</span>
</code></pre></div>
<p>For <code>--module-only</code>, you should make sure that both the <code>make_module_step</code>, including the <code>make_module_*</code> submethods,
and the <code>sanity_check_step</code> methods do not make any assumptions about the presence of certain environment variables, or that class variables have been defined already.</p>
<p>This is required because under <code>--module-only</code> the large majority of the <code>*_step</code> functions are
simply <em>skipped</em> entirely. So, if the <code>configure_step</code> method is responsible for defining class variables that are
picked up in <code>sanity_check_step</code>, the latter may run into unexpected initial values like <code>None</code>.
A possible workaround is to define a separate custom method to define the class variables, and to call out to this
method from <code>configure_step</code> and <code>sanity_check_step</code> (for the latter, conditionally, i.e., only if the class
variables still have the initial values).</p>
<p>For example:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">easybuild.framework.easyblock</span> <span class="kn">import</span> <span class="n">EasyBlock</span>


<span class="k">class</span> <span class="nc">EB_Example</span><span class="p">(</span><span class="n">EasyBlock</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Custom easyblock for Example&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Easyblock constructor.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">EB_Example</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">set_command</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize &#39;command&#39; class variable.&quot;&quot;&quot;</span>
        <span class="c1"># $CC environment variable set by &#39;prepare&#39; step determines exact command</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;CC&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">configure_step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Custom configure step for Example.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_command</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s1">&#39;configopts&#39;</span><span class="p">,</span> <span class="s2">&quot;COMMAND=</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">EB_Example</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">configure_step</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">sanity_check_step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Custom implementation of configure step for Example&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_command</span><span class="p">()</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">EB_Example</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">sanity_check_step</span><span class="p">(</span><span class="n">custom_commands</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">])</span>
</code></pre></div>
<h2 id="exercise">Exercise<a class="headerlink" href="#exercise" title="Permanent link">&para;</a></h2>
<h3 id="exercise-i1">Exercise I.1<a class="headerlink" href="#exercise-i1" title="Permanent link">&para;</a></h3>
<p>Try implementing a new custom easyblock for <code>eb-tutorial</code>, which derives directly
from the base <code>EasyBlock</code> class.</p>
<p>Your easyblock should:</p>
<ul>
<li>define a custom mandatory easyconfig parameter named <code>message</code>;</li>
<li>run <code>cmake</code> to configure the installation, which includes at least:<ul>
<li>specifying the correct installation prefix (using the <code>-DCMAKE_INSTALL_PREFIX=...</code> option);</li>
<li>passing down the value of <code>message</code> easyconfig parameter via <code>-DEBTUTORIAL_MSG=...</code></li>
</ul>
</li>
<li>run <code>make</code> to build <code>eb-tutorial</code>;</li>
<li>run <code>make install</code> to install the generated binary;</li>
<li>perform a custom sanity check to ensure the installation is correct;</li>
<li>pick up on commonly used easyconfig parameters like <code>configopts</code> and <code>preinstallopts</code> where appropriate;</li>
</ul>
<details class="success">
<summary>(click to show solution)</summary>
<p>Here's a complete custom easyblock for <code>eb-tutorial</code> that derives from the base <code>EasyBlock</code> class,
which should be included in a file named <code>eb_tutorial.py</code>.</p>
<p>We need to implement the <code>configure_step</code>, <code>build_step</code>, and <code>install_step</code> methods in
order to have a fully functional easyblock.</p>
<p>The configure, build, and install steps take into account the corresponding easyconfig
parameters that allow customizing these commands from an easyconfig file.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">easybuild.framework.easyblock</span> <span class="kn">import</span> <span class="n">EasyBlock</span>
<span class="kn">from</span> <span class="nn">easybuild.framework.easyconfig</span> <span class="kn">import</span> <span class="n">MANDATORY</span>
<span class="kn">from</span> <span class="nn">easybuild.tools.run</span> <span class="kn">import</span> <span class="n">run_cmd</span>


<span class="k">class</span> <span class="nc">EB_eb_minus_tutorial</span><span class="p">(</span><span class="n">EasyBlock</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Custom easyblock for eb-tutorial.&quot;&quot;&quot;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">extra_options</span><span class="p">():</span>
        <span class="n">extra</span> <span class="o">=</span> <span class="n">EasyBlock</span><span class="o">.</span><span class="n">extra_options</span><span class="p">()</span>
        <span class="n">extra</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
            <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Message that eb-tutorial command should print&quot;</span><span class="p">,</span> <span class="n">MANDATORY</span><span class="p">],</span>
        <span class="p">})</span>
        <span class="k">return</span> <span class="n">extra</span>

    <span class="k">def</span> <span class="nf">configure_step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Custom configure step for eb-tutorial: define EBTUTORIAL_MSG configuration option.&quot;&quot;&quot;</span>

        <span class="n">cmd</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="p">[</span><span class="s1">&#39;preconfigopts&#39;</span><span class="p">],</span>
            <span class="s2">&quot;cmake&quot;</span><span class="p">,</span>
            <span class="s2">&quot;-DCMAKE_INSTALL_PREFIX=&#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">installdir</span><span class="p">,</span>
            <span class="s2">&quot;-DEBTUTORIAL_MSG=&#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="p">[</span><span class="s1">&#39;configopts&#39;</span><span class="p">],</span>
        <span class="p">])</span>
        <span class="n">run_cmd</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">build_step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Build step for eb-tutorial&quot;&quot;&quot;</span>

        <span class="n">cmd</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="p">[</span><span class="s1">&#39;prebuildopts&#39;</span><span class="p">],</span>
            <span class="s2">&quot;make&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="p">[</span><span class="s1">&#39;buildopts&#39;</span><span class="p">],</span>
        <span class="p">])</span>
        <span class="n">run_cmd</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">install_step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Install step for eb-tutorial&quot;&quot;&quot;</span>

        <span class="n">cmd</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="p">[</span><span class="s1">&#39;preinstallopts&#39;</span><span class="p">],</span>
            <span class="s2">&quot;make install&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="p">[</span><span class="s1">&#39;installopts&#39;</span><span class="p">],</span>
        <span class="p">])</span>
        <span class="n">run_cmd</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">sanity_check_step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">custom_paths</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;files&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;bin/eb-tutorial&#39;</span><span class="p">],</span>
            <span class="s1">&#39;dirs&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="p">}</span>
        <span class="n">custom_commands</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;eb-tutorial&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">EB_eb_minus_tutorial</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">sanity_check_step</span><span class="p">(</span><span class="n">custom_paths</span><span class="o">=</span><span class="n">custom_paths</span><span class="p">,</span>
                                                                   <span class="n">custom_commands</span><span class="o">=</span><span class="n">custom_commands</span><span class="p">)</span>
</code></pre></div>
</details>
<h3 id="exercise-i2">Exercise I.2<a class="headerlink" href="#exercise-i2" title="Permanent link">&para;</a></h3>
<p>Try implementing another new custom easyblock for <code>eb-tutorial</code>,
which derives from the generic <code>CMakeMake</code> easyblock.</p>
<p>Your easyblock should only:</p>
<ul>
<li>define a custom mandatory easyconfig parameter named <code>message</code>;</li>
<li>pass down the value of <code>message</code> easyconfig parameter via <code>-DEBTUTORIAL_MSG=...</code></li>
<li>perform a custom sanity check to ensure the installation is correct;</li>
</ul>
<details class="success">
<summary>(click to show solution)</summary>
<p>When deriving from the <code>CMakeMake</code> generic easyblock, there is a lot less to worry about.</p>
<p>We only need to customize the <code>configure_step</code> method to ensure that the <code>-DEBTUTORIAL_MSG</code> configuration
option is specified; the <code>CMakeMake</code> easyblock already takes care of specifying the location of
the installation directory (and a bunch of other configuration options, like compiler commands and flags, etc.).</p>
<p>Implementing the <code>build_step</code> and <code>install_step</code> methods is no longer needed,
the standard procedure that is run by the <code>CMakeMake</code> generic easyblock is fine,
and even goes beyond what we did in the previous exercise (like building in parallel with <code>make -j</code>).</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">easybuild.easyblocks.generic.cmakemake</span> <span class="kn">import</span> <span class="n">CMakeMake</span>
<span class="kn">from</span> <span class="nn">easybuild.framework.easyconfig</span> <span class="kn">import</span> <span class="n">MANDATORY</span>
<span class="kn">from</span> <span class="nn">easybuild.tools.run</span> <span class="kn">import</span> <span class="n">run_cmd</span>

<span class="k">class</span> <span class="nc">EB_eb_minus_tutorial</span><span class="p">(</span><span class="n">CMakeMake</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Custom easyblock for eb-tutorial.&quot;&quot;&quot;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">extra_options</span><span class="p">():</span>
        <span class="n">extra</span> <span class="o">=</span> <span class="n">CMakeMake</span><span class="o">.</span><span class="n">extra_options</span><span class="p">()</span>
        <span class="n">extra</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
            <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Message that eb-tutorial command should print&quot;</span><span class="p">,</span> <span class="n">MANDATORY</span><span class="p">],</span>
        <span class="p">})</span>
        <span class="k">return</span> <span class="n">extra</span>

    <span class="k">def</span> <span class="nf">configure_step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Custom configure step for eb-tutorial: define EBTUTORIAL_MSG configuration option.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s1">&#39;configopts&#39;</span><span class="p">,</span> <span class="s2">&quot;-DEBTUTORIAL_MSG=&#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">])</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">EB_eb_minus_tutorial</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">configure_step</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">sanity_check_step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">custom_paths</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;files&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;bin/eb-tutorial&#39;</span><span class="p">],</span>
            <span class="s1">&#39;dirs&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="p">}</span>
        <span class="n">custom_commands</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;eb-tutorial&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">EB_eb_minus_tutorial</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">sanity_check_step</span><span class="p">(</span><span class="n">custom_paths</span><span class="o">=</span><span class="n">custom_paths</span><span class="p">,</span>
                                                                   <span class="n">custom_commands</span><span class="o">=</span><span class="n">custom_commands</span><span class="p">)</span>
</code></pre></div>
</details>

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">April 21, 2022</span>
      
    
  </small>
</div>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../creating_easyconfig_files/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Creating easyconfig files" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Creating easyconfig files
            </div>
          </div>
        </a>
      
      
        
        <a href="../part3_advanced/" class="md-footer__link md-footer__link--next" aria-label="Next: (overview)" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              (overview)
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
      
      
    
    <a href="https://twitter.com/easy_build" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://www.youtube.com/c/easybuilders" target="_blank" rel="noopener" title="www.youtube.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://easybuild.readthedocs.io" target="_blank" rel="noopener" title="easybuild.readthedocs.io" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M448 336V48c0-26.51-21.5-48-48-48H96C42.98 0 0 42.98 0 96v320c0 53.02 42.98 96 96 96h320c17.67 0 32-14.33 32-31.1 0-11.72-6.607-21.52-16-27.1v-81.36c9.8-9.64 16-22.24 16-36.44zM143.1 128h192c9.7 0 16.9 7.2 16.9 16s-7.2 16-16 16H143.1c-7.9 0-15.1-7.2-15.1-16s7.2-16 15.1-16zm0 64h192c9.7 0 16.9 7.2 16.9 16s-7.2 16-16 16H143.1c-7.9 0-15.1-7.2-15.1-16s7.2-16 15.1-16zM384 448H96c-17.67 0-32-14.33-32-32s14.33-32 32-32h288v64z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["instant"], "search": "../../assets/javascripts/workers/search.2a1c317c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.3a4b43e5.min.js"></script>
      
    
  </body>
</html>